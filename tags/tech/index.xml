<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Tech on NebulaNovaLife</title>
    <link>https://celiachu.github.io/tags/tech/</link>
    <description>Recent content in Tech on NebulaNovaLife</description>
    <generator>Hugo -- 0.154.2</generator>
    <language>zh</language>
    <copyright>2025 NebulaNova</copyright>
    <lastBuildDate>Wed, 16 Jul 2025 19:33:26 +0800</lastBuildDate>
    <atom:link href="https://celiachu.github.io/tags/tech/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ä»é›¶å®ç°ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼šHope é¡¹ç›®å®è·µè®°å½•</title>
      <link>https://celiachu.github.io/post/2025/reinventing-testing-from-scratch/</link>
      <pubDate>Wed, 16 Jul 2025 19:33:26 +0800</pubDate>
      <guid>https://celiachu.github.io/post/2025/reinventing-testing-from-scratch/</guid>
      <description>ä¸€ç¯‡è®°å½•å¦‚ä½•ä»é›¶å®ç° JavaScript å•å…ƒæµ‹è¯•æ¡†æ¶ Hope çš„å·¥ç¨‹å®å½•ï¼Œæ¶µç›–è®¾è®¡åŠ¨æœºã€æ¨¡å—åˆ’åˆ†ã€é’©å­æœºåˆ¶ã€æ‰§è¡Œé¡ºåºã€æ¶æ„æ€è€ƒç­‰æ ¸å¿ƒå†…å®¹</description>
      <content:encoded><![CDATA[<h1 id="ä»é›¶å®ç°ä¸€ä¸ªæµ‹è¯•æ¡†æ¶hope-é¡¹ç›®å®è·µè®°å½•">ä»é›¶å®ç°ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼šHope é¡¹ç›®å®è·µè®°å½•</h1>
<h2 id="ç¼˜èµ·">ç¼˜èµ·</h2>
<p>ä¸ºä»€ä¹ˆè¦è‡ªå·±å®ç°ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Ÿ</p>
<blockquote>
<p>é˜…è¯»äº† <a href="https://ramsayleung.github.io/zh/post/2025/reinvent_unit_test/">ã€Šé‡æ–°é€ è½®å­ç³»åˆ—(ä¸€)ï¼šå•å…ƒæµ‹è¯•æ¡†æ¶ã€‹</a>ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯è¿™ä¸ªæ–‡ç« çš„å®è·µï¼Œå› ä¸ºæœ¬äººä¹Ÿç”¨è¿‡ Jest å’Œ Mocha ï¼Œäº†è§£è¿™ä¸¤ä¸ªæµ‹è¯•æ¡†æ¶çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å°è¯•è‡ªå·±å®ç°ä¸€ä¸ªæ–°çš„æµ‹è¯•æ¡†æ¶ï¼Œå¹¶æ²¡æœ‰è§£å†³å…¶ä»–ç—›ç‚¹ï¼Œä¸ºäº†å­¦ä¹  js ä»£ç å’ŒCLIæ¶æ„ã€‚</p>
</blockquote>
<h2 id="é¡¹ç›®ç›®å½•ç»“æ„æ¦‚è§ˆ">é¡¹ç›®ç›®å½•ç»“æ„æ¦‚è§ˆ</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hope-test/
</span></span><span class="line"><span class="cl">â”œâ”€â”€ src/
</span></span><span class="line"><span class="cl">â”‚   â”œâ”€â”€ hope.ts      // æ ¸å¿ƒæµ‹è¯•æ¡†æ¶å®ç°
</span></span><span class="line"><span class="cl">â”‚   â””â”€â”€ pray.ts      // å‘½ä»¤è¡Œå·¥å…·å±‚
</span></span><span class="line"><span class="cl">â”œâ”€â”€ tests/           // æµ‹è¯•ç”¨ä¾‹
</span></span><span class="line"><span class="cl">â”œâ”€â”€ package.json
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>hope.ts</code>: æµ‹è¯•æ¡†æ¶æ ¸å¿ƒï¼Œè´Ÿè´£æµ‹è¯•æ³¨å†Œã€é’©å­æ‰§è¡Œã€æ–­è¨€ã€é”™è¯¯åˆ†ç±»ç­‰é€»è¾‘</li>
<li><code>pray.ts</code>: CLI å…¥å£ï¼Œè´Ÿè´£å‚æ•°è§£æã€ç»“æœå±•ç¤ºã€æŠ¥å‘Šç”Ÿæˆ</li>
</ul>
<h2 id="æ ¸å¿ƒè®¾è®¡ç†å¿µ">æ ¸å¿ƒè®¾è®¡ç†å¿µ</h2>
<h3 id="hope-ç±»">Hope ç±»</h3>
<p>æ ¸å¿ƒå±æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>suites</code>ï¼šå®Œæ•´çš„æµ‹è¯•å¥—ä»¶æ ‘ç»“æ„</li>
<li><code>currentSuite</code>ï¼šå½“å‰æ­£åœ¨æ³¨å†Œçš„å¥—ä»¶</li>
<li><code>passes / fails / errors</code>ï¼šæ‰§è¡Œç»“æœåˆ†ç±»</li>
</ul>
<h3 id="æµ‹è¯•æ³¨å†Œæœºåˆ¶">æµ‹è¯•æ³¨å†Œæœºåˆ¶</h3>
<p>æµ‹è¯•æ–‡ä»¶ä¸­æ³¨å†Œç”¨ä¾‹çš„åŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">test</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;../src/hope&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;my first test&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// some logic
</span></span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™äº›æ³¨å†Œä»£ç åœ¨â€œåŠ è½½æ¨¡å—ç¬é—´â€å³è¢«æ‰§è¡Œï¼ŒHope ä¼šå°†æµ‹è¯•ä¿¡æ¯æ³¨å†Œåˆ° <code>currentSuite.tests</code> ä¸­ã€‚</p>
<h3 id="å¥—ä»¶åµŒå¥—ä¸æ ‘ç»“æ„">å¥—ä»¶åµŒå¥—ä¸æ ‘ç»“æ„</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;Suite A&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Test A1&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;Suite B&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Test B1&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{});</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤ç»“æ„æœ€ç»ˆæ„æˆä¸€ä¸ªæ ‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">root
</span></span><span class="line"><span class="cl">â”œâ”€â”€ Suite A
</span></span><span class="line"><span class="cl">â”‚   â”œâ”€â”€ Test A1
</span></span><span class="line"><span class="cl">â”‚   â””â”€â”€ Suite B
</span></span><span class="line"><span class="cl">â”‚       â””â”€â”€ Test B1
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é’©å­ç³»ç»Ÿä¸æ‰§è¡Œé¡ºåº">é’©å­ç³»ç»Ÿä¸æ‰§è¡Œé¡ºåº</h3>
<p>æ”¯æŒå››ç§é’©å­ï¼š<code>beforeAll</code>, <code>beforeEach</code>, <code>afterEach</code>, <code>afterAll</code></p>
<p>æ‰§è¡Œé¡ºåºç¤ºæ„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">A beforeAll
</span></span><span class="line"><span class="cl">A beforeEach
</span></span><span class="line"><span class="cl">Test A1
</span></span><span class="line"><span class="cl">A afterEach
</span></span><span class="line"><span class="cl">B beforeAll
</span></span><span class="line"><span class="cl">A beforeEach
</span></span><span class="line"><span class="cl">B beforeEach
</span></span><span class="line"><span class="cl">Test B1
</span></span><span class="line"><span class="cl">B afterEach
</span></span><span class="line"><span class="cl">A afterEach
</span></span><span class="line"><span class="cl">B afterAll
</span></span><span class="line"><span class="cl">A afterAll
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>beforeEachçš„hookä¼šä»çˆ¶åˆ°å­æ‰§è¡Œï¼Œå…·ä½“æ”¶é›†hooksçš„ä»£ç æ˜¯whileå¾ªç¯ä¸æ–­å‘çˆ¶èŠ‚ç‚¹æ”¶é›†
ç‰¹åˆ«æ³¨æ„ï¼š<code>afterEach</code> çš„æ‰§è¡Œé¡ºåºæ˜¯åå‘çš„ï¼Œå› æ­¤éœ€è¦ <code>reverse()</code></p>
</blockquote>
<h2 id="-cli-æ¨¡å—prayts">ğŸ“‚ CLI æ¨¡å—ï¼ˆpray.tsï¼‰</h2>
<ul>
<li>ä½¿ç”¨ <code>minimist</code> è§£æå‘½ä»¤è¡Œå‚æ•°</li>
<li>æ ¹æ®å‚æ•°å†³å®šè¾“å‡ºæ¨¡å¼ï¼ˆterse / JSON / future HTMLï¼‰</li>
</ul>
<h2 id="é”™è¯¯å¤„ç†æœºåˆ¶">é”™è¯¯å¤„ç†æœºåˆ¶</h2>
<p>æ¡†æ¶åŒºåˆ†ä¸¤ç§é”™è¯¯ï¼š</p>
<table>
  <thead>
      <tr>
          <th>åˆ†ç±»</th>
          <th>è¯´æ˜</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>fail</code></td>
          <td>æ–­è¨€å¤±è´¥</td>
          <td><code>assert(false)</code></td>
      </tr>
      <tr>
          <td><code>error</code></td>
          <td>å¼‚å¸¸ä¸­æ–­</td>
          <td><code>throw new Error()</code></td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>runHooks æ–¹æ³•æœªå¤„ç†å¼‚å¸¸ï¼Œå¼‚å¸¸å°†ç”± <code>runSuite()</code> ä¸­çš„ try&hellip;catch æ•è·ã€‚</p>
</blockquote>
<h2 id="ç”Ÿå‘½å‘¨æœŸ">ç”Ÿå‘½å‘¨æœŸ</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">[</span><span class="nb">load</span> <span class="n">tests</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">register</span> <span class="n">describe</span><span class="o">/</span><span class="n">test</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">build</span> <span class="n">suite</span> <span class="n">tree</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="err">â†“</span>
</span></span><span class="line"><span class="cl">     <span class="p">[</span><span class="n">hope</span><span class="o">.</span><span class="n">run</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">         <span class="err">â†“</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">runSuiteé€’å½’æ‰§è¡Œ</span><span class="err">ï¼Œæ¯å±‚</span><span class="n">beforeAll</span><span class="err">â†’æµ‹è¯•â†’</span><span class="n">afterAll</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="err">â†“</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="err">ç”ŸæˆæŠ¥å‘Šï¼š</span><span class="n">console</span><span class="o">/</span><span class="n">json</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>è¯»ä¸€ç™¾æ¬¡è¿™ä¸ªæ–‡ç« æ²¡æœ‰è‡ªå·±å†™ä¸€ä¸ªæ¥çš„å®åœ¨</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
